title: "インフラ入門vol.2(ネットワーク)"
date: 2017/07/04 15:04:04
postid: ""
tag:
  - Network
  - Infrastructure
  - インフラ入門
  - 入門
category:
  - Infrastructure
author: 洞内惇
featured: true
lede: "ンフラエンジニアの若手がネットワーク設計の現場で向き合っていく事柄について、説明します"
---
# はじめに
みなさま、こんにちは。洞内です。

今回は[インフラ入門](/tags/%E3%82%A4%E3%83%B3%E3%83%95%E3%83%A9%E5%85%A5%E9%96%80/)のvol.2と題して、インフラエンジニアの若手がネットワーク設計の現場で向き合っていく事柄（ここでは手段ではなく、設計の検討で外してはいけないポイント）について、説明します。

* [インフラ概要と当社でのインフラエンジニア像](/articles/20170109/)
* [インフラ入門vol.3(ネットワーク冗長化構成)](/articles/20191107/)
* [ストレージ](/articles/20200414/)
* [インフラ要件定義編](/articles/20210305/)

# ネットワークって？

ネットワークとは「網状に作られた何か」（by Wikipedia）ですが、ITインフラにおけるネットワークとは、**コンピューターAからコンピューターBへとデータを送るための通信経路** の事を指します。
<img src="/images/20170704/photo_20170704_01.png">


身近なものでイメージをするのであれば、電話、メール、SNS等はネットワークが存在して、その上をデータがやり取りされている事が大前提となる機能です。
電話であれば「音声データ」、メールやSNSであれば「文字データや画像データ」等を、相手のスマートフォンに届けるために、通信経路となる「ネットワーク」が使われている訳ですね。
<img src="/images/20170704/photo_20170704_02.png">

身近なものを例に挙げましたが、業務システム（業務アプリケーション）でも同じことが言えます。
例えば、お店で不足した商品を補充する発注業務等でもネットワークを通じて、商品を注文していますし、遠く離れた相手とTV会議をするにもネットワークが使われています。

では、様々な場面で利用されているネットワークですが、どのようなポイントを意識して設計するのかを考えていきたいと思います。


# 設計の要件
ネットワークを設計する際のポイントとなる要件は以下です。

1. だれがどのように使うのか
2. どの位のデータが流れるのか
3. 機械の故障等による停止はどの程度まで許容できるのか

上から順番に見てみましょう。

## 1. だれがどのように使うのか

例えば、以下のように状況によって用意すべきネットワークは異なります。

**a. 会社員の方が、必ず会社のオフィスの自席で使う**
→この場合、ネットワークは有線で用意すれば良いでしょう

**b. 会社員の方が、会社のオフィス内の色々な場所で使う**
→この場合、ネットワークは無線の方が良いですね？

**c. 会社員の方が、客先でお客様と商談をしながら使う**
→こうなってくると、モバイルWi-Fiを使う事も検討する必要がでてきます

<img src="/images/20170704/photo_20170704_03.png">

利用者がどのようなシチュエーションで利用するのかは、ネットワークを設計する上での非常に重要なポイントですね。

他にも、考慮すべき点は色々考えられると思います。

**d. インターネット上にWebサイトを公開するので、不特定多数の人がアクセスする**
→この場合は、使い勝手の話だけではなく、不正アクセスの対策等も必要になってきます。
（もちろん、アプリケーションに不具合を作らない事も重要ですが、ネットワークの設計や設定としても不要な通信は通さないといった事を考える必要があります）


## 2. どの位のデータが流れるのか

例えば、家庭のインターネットサービスでも、10Mbps、100Mbps、1Gbps等の通信速度の違うサービスがありますね。
これは用途にあったサービスプランを選ぶと思います。

* メールや、ちょっと調べ物をしたいだけの人は10Mbps
* 動画をたくさん見たい人は100Mbps～1Gbps

動画をたくさん見たい人が、10Mbpsの回線を契約した場合は通信速度が遅くて動画がカクカクしてしまうかもしれませんね。また、**複数人で同じ10Mbpsの回線を使っている場合、他の人もなかなかメールが送れない**といった状況になるかもしれません。

<img src="/images/20170704/photo_20170704_04.png">


ネットワークの設計をする上では、**どの位のデータが流れるのか** や **今後、どの位のデータが流れるのか** を考慮する必要があります。

家庭用のインターネットサービスでは、契約を変更して、機械を取り換えれば大体の場合は増速ができますが、会社の中のネットワークで増速しようとすると、大規模な工事が必要になる場合がほとんどです。

そのため、**目的や使用用途を明確にして、どの位のデータがネットワークを流れるのか**を見極めて設計をする必要があります。


## 3. 機械の故障等による停止はどの程度まで許容できるのか

ネットワークを構成している機械もモノなので、いつかは故障しますし、それは突然訪れる事がままあります。

そんな突然故障した時に、ネットワークはどの程度の時間、使えないままになるのでしょうか？
5分？1時間？1日？

企業のネットワークがまるまる1日止まってしまったら大損失ですね。
そんな時のために、予備の機械を用意したり、壊れたときにすぐに自動で切り替えができる機械を用意したりすることを考えます。

当然、予備の機械の用意や、自動切り替えの機能がついた機械は値段も高くなりますので、**全体の中で通信が止まってはいけないポイントはどこなのか** を整理して、重要な箇所から優先的に投資を行うことが必要となってきます。

<img src="/images/20170704/photo_20170704_05.png">


# 設計の構成

前述の要件に加え、企業のネットワーク構成の設計には、以下の3つのポイントがあります。

1. ネットワークのコア
2. LANとWANの利用
3. クラウドの利用

こちらも順番にみていきましょう。


## 1. ネットワークのコア

ネットワークを構築する際、ほとんどの場合がコアルーターやコアスイッチと呼ばれるような、ネットワークの中心となる機械を用意します。

コアには沢山のデータが集まるため末端の機械よりも高い処理能力が必要になります。

また、通信が集中するため、不要な通信をブロックするファイアウォール機能や、通信の流量をコントロール（トラフィックシェーピング）して、セキュリティ性を高めたり、皆が快適に使えたりするといった制御を担うのがコアになります。

そのため、コアとなる機械が故障すると、全ネットワークが停止する恐れがあるため、先ほど挙げた**機械の故障等による停止はどの程度まで許容できるのか**という考え方の中で、非常に重要度の高いポイントと言えますね。

 
## 2. LANとWANの利用

そもそも、LANとWANとはなんぞや？という方もいらっしゃると思いますので、簡単に説明します。

> * LAN(Local Area Network)
>   * 1つの建物や、1つの組織の中で運用されるネットワークを指す言葉
> * WAN(Wide Area Network):
>   * LANに対して、もっと広範囲に広がるネットワークを指す言葉。一般的にはインターネットサービスプロバイダが持つネットワークをWANと呼ぶ。

LANは、何となくイメージが出来るかもしれません。
でも、WANはどうでしょうか？ちょっとぼんやりしたイメージかもしれませんね。
もう少し具体的にしましょう。

私たちが家庭でインターネットを利用する際、ほとんどの人が、インターネットサービスプロバイダと契約をして、インターネットを利用していると思います。
この時、契約内容にもよりますが、多くの場合はルーターと呼ばれる機械を用意して、このルーターに複数のPCやTV、ゲーム機等を接続して、インターネットを利用していると思います。
実はこのルーターの下に繋いだPC、TV、ゲーム機は1つのネットワークに所属しており、このネットワークの事をLANと言います。

また、ルーターを挟んで反対側(インターネットサービスプロバイダ側)をWANと言います。
このWANと呼ばれる、インターネットサービスプロバイダ側のネットワークがたくさん集まり、繋がっている物がインターネットと呼ばれるものです。言い換えると、インターネットとは様々なWANの集合体ということですね。

さて、話を戻して、当社の顧客には企業規模の大きなお客様が多く、オフィスも1つではなく、たくさんの拠点を構えていらっしゃいます。そのため1つの建物内で構成されたLANでは、業務遂行にあたり不便な部分が出てきてしまいます。

例えば、会計処理をするにあたり東京、名古屋、大阪それぞれのオフィスで処理したものを集めて、また合算するよりも、1ヶ所で処理をした方が早いですよね？

他にも同じ文書ファイルを各オフィスに配布するときに、それぞれの拠点の担当者にメールで配布をするよりも、ファイルサーバ上に置いて、1ヶ所から皆が参照をする方が効率的ですね。そのため、各拠点のLANをWANで繋いで、1つのLANとして扱うような設計を行う事が多くあります。

このように複数の拠点をまたぐLANを設計する場合、先ほど挙げたようなポイントを検討する必要があります。

* 通信内容をどのように保護(第三者に傍受されないように)するのか。
* ネットワークのコアをどこに配置するのか
* だれがどのように使うのか。
* どの位のデータが流れるのか。
* 機械の故障等による停止はどの程度まで許容できるのか。

他にも、

* ネットワーク上の住所となるIPアドレスをどのように割り当てるのか。
* 将来拠点が増えたら、どのように拡張するのか。
* 重要なデータのある場所へのアクセス制御の有無。
* 通信のレイテンシ(遅延)はどうか。

などなど考えることは様々です。


## 3. クラウドの利用

昨今、このクラウドという単語は、IT業界だけではなく一般的にも浸透してきたのではないでしょうか？
一言でクラウドといっても、多種多様なサービスがありますが、共通していることがいくつかあります。

* 必要な時に必要な分だけ機能やサービスを利用する
* ネットワーク経由での利用が前提

クラウドサービスはネットワーク経由での利用が前提になっているのですね。
クラウドへの接続の方法は、多くはインターネット経由ですが、クラウドサービスの提供側が対応していれば、WAN経由での接続も可能です。

先ほど、WANを使って各拠点のLANを1つにまとめるといった話をしましたが、クラウドサービスも、そんなLANの1つとして扱う事ができる訳ですね。

ただし、当然ですが何でもかんでも繋げば良いという事ではなく、限られた予算の中でどのようにするのが一番良いのかを常に考えて、不要なのであれば切り捨てるといった判断をする事も必要です。


# プロジェクトを進める上でのネットワーク

実際にプロジェクトの中では、ほとんどの企業が既にネットワークを持っている場合が多いのですが、新しく作るシステムを作る上で、ネットワークを拡張するための設計や対応が必要な場合があります。

そんな時、インフラの構築の中でも特にネットワークはプロジェクト全体の進行に対して大きく先行して進めなければなりません。

ネットワークを作るためには、機械の発注や購入だけではなく、建物工事や、通信が正しく行えるか疎通試験等も行う必要があるからです。

その他にも、お客様自身が自社のネットワークを網羅しきれておらず、現行のネットワーク調査を行う必要が有る場合等もあります。

こういった作業に対するスケジュールや、見積り、設計を誤ってしまうと、プロジェクトの進行が大きく遅れるだけではなく、お客様に想定外の出費をさせてしまう可能性があります。

実際に、当社の中でも建物工事を行う業者の繁忙期閑散期を見誤り、実際に工事が行えるタイミングが当初想定より遅れてしまいギリギリでの対応となったことや、いざ使い始めてみると、当初の想定見積よりも多くの通信が流れており、通信の圧縮処理や、通信処理が集中する時間を分散させて影響を最小限に留めるように業務処理の見直しを行った事などもあります。


# おわりに

いかがでしたでしょうか？
普段、多くの方々はあまりネットワークについて意識をしていないかもしれません。

その理由は[インフラ入門vol1](https://future-architect.github.io/articles/20170109/)にもありましたが、ITインフラが**動いて当たり前**だからです。ただ、実際に壊れない機器は無いですし、**メールだけ出来れば良い** としていた環境でだれかが勝手に**動画も配信！** となれば、その元々の要件下での **動いて当たり前** は崩れてしまいます。

この **動いて当たり前** を崩れないようにしっかりと作りつつ、今後の拡張性や、セキュリティ、予算等のバランスを取って作り上げる事がネットワークの設計に求められることです。


では、また次回をお楽しみに。

---

* [インフラ入門vol.1](/articles/2017/01/09)
* [インフラ入門vol.2(ネットワーク)](/articles/20170704/)
* [インフラ入門vol.3(ネットワーク冗長化構成)](/articles/20191107/)
* [インフラ入門vol.4((ストレージ)](/articles/20200414/)
* [俺のインフラデザインパターン　～過去の失敗に学ぶニッチなインフラの話～](/articles/2019/07/31)
